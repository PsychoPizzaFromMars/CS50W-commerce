{% extends "auctions/layout.html" %}

{% block body %}
<h2>{{ listing.title }}</h2>
{% if user.is_authenticated %}
{% if is_watchlisted %}

<form method='post' action="{% url 'user-watchlist-rm' %}">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ request.path }}">
    <input type="hidden" name="listing" value="{{ listing.id }}">
    <button class="badge badge-danger" type="submit">- Watchlist</button>
</form>

{% else %}

<form method='post' action="{% url 'user-watchlist-add' %}">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ request.path }}">
    <input type="hidden" name="listing" value="{{ listing.id }}">
    <button class="badge badge-success" type='submit'>+ Watchlist</button>
</form>

{% endif %}
{% endif %}


<p>Created {{ listing.date }} by {{ listing.user }}</p>

{% if listing.item_image %}

<img id="item_img" height="300" src="{{ listing.item_image }}">

{% else %}

<img id="item_img" width="250"
    src="https://static.wikia.nocookie.net/houseki-no-kuni/images/3/3b/Missingimage.png/revision/latest?cb=20190328111547&path-prefix=ru">

{% endif %}

<hr>
<p>Category: <a href="{% url 'category_items' category_id %}">{{ listing.category }}</a></p>
<hr>
<p>{{ listing.desc }}</p>

{% if max_bid %}

<p>Current bid: ${{ max_bid.value }} by {{ max_bid.user }}</p>

{% else %}

<p>Starting bid: ${{ listing.start_bid }}</p>

{% endif %}
{% if user.is_authenticated %}
<form method='post' action="{% url 'new_bid' %}">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ request.path }}">
    <input type="hidden" name="listing" value="{{ listing.id }}">
    <input type="number" step=".01" name="bid_value" value="{{ bid_value }}">
    <input class="btn btn-primary" type="submit" value="Bid">
</form>
{% endif %}
{% endblock %}